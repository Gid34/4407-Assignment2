#!/bin/bash
# Usage: ./empty_cells <input_file> <separator>
# Example: ./empty_cells bgg_dataset.txt ";"

input_file="$1"
separator="$2"

# Get header columns
IFS=$separator read -r -a headers < "$input_file"
num_cols="${#headers[@]}"
declare -a col_counts

# Initialize array to 0
for ((i = 0; i < num_cols; i++)); do
    col_counts[i]=0
done

# Skip header line and count empty cells
tail -n +2 "$input_file" | while IFS=$separator read -r -a fields; do
    for ((i = 0; i < num_cols; i++)); do
        if [[ -z "${fields[i]// /}" ]]; then
            ((col_counts[i]++))
        fi
    done
done

# Output results
for ((i = 0; i < num_cols; i++)); do
    echo "${headers[i]}: ${col_counts[i]}"
done
